# 0001. 開発環境におけるDockerとパッケージマネージャーuvの採用

- **ステータス**: 採用 (Accepted)
- **決定日**: 2026-02-11
- **検討者**: User
- **タグ**: infrastructure, environment, package-management

## コンテキスト (Context)

自律型AIエージェントの開発において、以下の懸念点があった。
1.  **安全性 (Safety)**: エージェントが開発者のローカル環境（ホストOS）に対して破壊的な操作（ファイルの削除、システム設定の変更など）を行うリスクがある。
2.  **再現性 (Reproducibility)**: チームメンバー間やCI/CD環境で、OS依存やライブラリバージョンの不一致による問題を防ぎたい。
3.  **効率性 (Efficiency)**: Pythonのパッケージインストールや依存解決にかかる時間を短縮したい。

## 決定 (Decision)

以下の構成を採用することを決定した。

1.  **ランタイム環境としてDockerを使用する (MUST)**
    -   OSレベルでの隔離を実現し、エージェントの操作によるホストOSへの悪影響を遮断する（Sandbox化）。
    -   開発環境と実行環境をDockerコンテナとして定義し、再現性を保証する。

2.  **パッケージマネージャーとしてuvを使用する (MUST)**
    -   Pythonの標準的な `pip` ではなく、Rust製の高速なパッケージマネージャー `uv` を採用する。
    -   Dockerビルド時の依存解決とインストール時間を大幅に短縮するため。
    -   依存関係の管理には `pyproject.toml` と `uv.lock` を使用する。

## 詳細 (Implications)

-   **Dockerfile**: マルチステージビルドを採用し、`ghcr.io/astral-sh/uv:latest` から `uv` バイナリをコピーして使用する。
-   **Volume Mount**: ホスト側のソースコードディレクトリ (`./src`) と、エージェントが自由に読み書きできるサンドボックスディレクトリ (`./sandbox`) をコンテナにマウントする。
-   **Workflow**: 開発者は `docker compose up --build` コマンドで環境を立ち上げ、コンテナ内でエージェントを実行・テストする。

## 備考 (Notes)

-   この決定は、今後の全ての開発フェーズにおいて適用される。
-   ローカルマシン（ホストOS）に直接Python環境を構築することは推奨されない。
